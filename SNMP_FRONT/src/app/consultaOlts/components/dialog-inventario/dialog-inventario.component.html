<section>
  <mat-grid-list cols="2" rowHeight="50px">
    <mat-grid-tile [colspan]="2">
      <h5> HOMOLOGACIÓN ONTS</h5>
    </mat-grid-tile>
    <mat-grid-tile>
      <p>ID OLT: {{oltSeleccionada.id_olt}} {{oltSeleccionada.nombre}} ({{oltSeleccionada.ip}})</p>
    </mat-grid-tile>
    <mat-grid-tile>
      <button mat-icon-button [disabled]="estaSincronizandose" (click)="sincronizar()" color="primary">
        <mat-icon matTooltip="Sincronizar">sync</mat-icon>
      </button>
      Fecha Última Sincronización: {{this.ultimaActualizacion|dateFormat}}
    </mat-grid-tile>
  </mat-grid-list>
</section>
<mat-divider></mat-divider>
<br>
<!-- Aqui inician las tabs -->
<mat-tab-group mat-stretch-tabs="false" mat-align-tabs="start">
  <mat-tab label="Sincronización">

    <mat-accordion>
      <mat-expansion-panel [expanded]="true" id="dates" hideToggle>
        <mat-expansion-panel-header class="panelTitle">
          <mat-panel-title>
            <img class="icon-avata" src="./assets/img/search.SVG" />
          </mat-panel-title>
          <mat-panel-description>
            Criterios de búsqueda
          </mat-panel-description>
        </mat-expansion-panel-header>
        <form class="example-form">
          <mat-form-field [formGroup]="myGroup" class="example-full-width">
            <mat-label>Fecha Inicio</mat-label>
            <input matInput type="date" formControlName="fechaIni" #fechaIni>
          </mat-form-field>

          <mat-form-field [formGroup]="myGroup" class="example-full-width">
            <mat-label>Fecha Fin</mat-label>
            <input type="date" matInput formControlName="fechaFin" #input>
          </mat-form-field>
          <button mat-raised-button type="submit" (click)="filtrarPorRangoFechas()">Consultar</button>
        </form>
      </mat-expansion-panel>
    </mat-accordion>

    <br>
    <div class="example-loading-shade" *ngIf="isLoadingResults || isRateLimitReached">
      <mat-spinner *ngIf="isLoadingResults"></mat-spinner>
      <div class="example-rate-limit-reached" *ngIf="isRateLimitReached">
        No hay Información disponible.
      </div>
      <div class="example-rate-limit-reached" *ngIf="isLoadingResults">
        Cargando informacion...
      </div>
    </div>

    <div class="example-table-container">
      <section class="example-container">
        <table mat-table [dataSource]="dataSource" class="example-table" matSort matSortActive="created"
          matSortDisableClear matSortDirection="desc">

          <ng-container matColumnDef="numero_serie">
            <th mat-header-cell *matHeaderCellDef> Numero Serie </th>
            <td mat-cell *matCellDef="let element"> {{element.numero_serie}} </td>
          </ng-container>

          <ng-container matColumnDef="oid">
            <th mat-header-cell *matHeaderCellDef> OID </th>
            <td mat-cell *matCellDef="let element"> {{element.oid | textPipe}} </td>
          </ng-container>

          <ng-container matColumnDef="frame">
            <th mat-header-cell *matHeaderCellDef> Frame </th>
            <td mat-cell *matCellDef="let element"> {{element.frame}} </td>
          </ng-container>

          <ng-container matColumnDef="slot">
            <th mat-header-cell *matHeaderCellDef> Slot </th>
            <td mat-cell *matCellDef="let element"> {{element.slot}} </td>
          </ng-container>

          <ng-container matColumnDef="port">
            <th mat-header-cell *matHeaderCellDef> Port </th>
            <td mat-cell *matCellDef="let element"> {{element.port}} </td>
          </ng-container>

          <ng-container matColumnDef="fecha_descubrimiento">
            <th mat-header-cell *matHeaderCellDef> Fecha Descubrimiento </th>
            <td mat-cell *matCellDef="let element"> {{element.fecha_descubrimiento | dateFormat}} </td>
          </ng-container>

          <!-- <ng-container matColumnDef="acciones">
          <th mat-header-cell *matHeaderCellDef> Eventos </th>
          <td mat-cell *matCellDef="let element">
            <button mat-button (click)="moverAInventario()">Agregar</button>
          </td>
        </ng-container> -->

          <ng-container matColumnDef="acciones">
            <th mat-header-cell *matHeaderCellDef>
              Acciones
            </th>
            <td mat-cell *matCellDef="let row">
              <button mat-icon-button [matMenuTriggerFor]="animals" aria-label="Example icon-button with a menu">
                <mat-icon matTooltip="Acciones">settings</mat-icon>
              </button>
              <mat-menu #animals="matMenu">
                <button mat-menu-item (click)="moverAInventario(row.numero_serie, 'R')">Residencial</button>
                <button mat-menu-item (click)="moverAInventario(row.numero_serie, 'E')">Empresarial</button>
              </mat-menu>
            </td>
          </ng-container>

          <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell">
              <p>Sincronizando con el servidor...</p>
              <mat-spinner color='primary'></mat-spinner>
              <!-- <mat-grid-list cols="1" rowHeight="1:1">
                <mat-grid-tile>
                </mat-grid-tile>
              </mat-grid-list> -->
            </td>
          </tr>
          <tr mat-header-row *matHeaderRowDef="displayedColumns ;sticky:true"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </section>
    </div>
  </mat-tab>
  <mat-tab label="Detalle de Sincronización">
    <app-logs [logs]="status"></app-logs>
  </mat-tab>
</mat-tab-group>